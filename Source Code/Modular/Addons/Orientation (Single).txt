er="\nH:LOS\nH:LOS" ah="\nH:" ap="\nP:" f=360 q=180 p=0.5
x=xl-:XX y=:YY-yl z=:ZZ-zl h=sqrt(x^2+y^2) xl=:XX yl=:YY zl=:ZZ
:HH=atan(x/y)+q+(y>0)*((x<0)-p)*f :PP=atan(z/h) o=ah+:HH+ap+:PP
if :CL>0 then :Orn=o if :SD<4 then :Orn=er end goto2 end goto4

MEM
:HH // heading (0..360)
:PP // pitch (-90..90)
:Orn // easy orientation out

1.3